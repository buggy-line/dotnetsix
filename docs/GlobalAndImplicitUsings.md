# Global and implicit usings

".NET 6 introduces implicit namespace support for C# projects. To reduce the amount of using directives boilerplate in .NET C# project templates, namespaces are implicitly included by utilizing the global using feature introduced in C# 10."

<br/>

## Global usings

The syntax change is minor, one can now add the `global` keyword before any using statment like so:

```C#
global using System;

```

There is a small restriction, they have to be added outside namespace declarations, see below:

```C#
global using Xunit;     // OK

namespace ValueRecord;

global using Xunit;     // not allowed!
using Xunit;            // OK

```

```C#

global using Xunit;     // OK
namespace ValueRecord
{
    global using Xunit; // not allowed!
    using Xunit;        // OK!
}

```

<br/>

Adding a global namespace will be available to any class in the current project.
There is no well defined place to add these global usings, in theory you can add them to any `.cs` file, and duplicating them **will not cause** compiler error or  warnings, just an intellisense suggestion to remove the duplicate.

<br/>

With that out of the way, I think a potential best practice is to use a file in the root of your project called [GlobalUsings.cs](https://github.com/buggy-line/dotnetsix/blob/main/dotnetsix/LanguageFeatures/GlobalUsings.cs) to aggregate your global namespaces. I will reference this practice again at the end of this page when discussing `implicit usings`.

<br/>

## Implicit (global) usings

Implicit global usings are an optional feature enabled by default in new .NET 6/C# 10 projects. For existing projects that you want migrated, you will need a new entry in the [csproj files](https://github.com/buggy-line/dotnetsix/blob/main/dotnetsix/dotnetsix/dotnetsix.csproj#L6):

```XML
<ImplicitUsings>enable</ImplicitUsings>
```

If you create a new project in Visual Studio 2022 (or using the latest SDK from the command line), this flag is added by default and is enabled.

The list of enabled using is not defined inside the .csproj file. They are present in a hidden autogenerated file, inside the project's obj folder. The path should look like this: `[ProjectName]\obj\Debug\net6.0\[ProjectName].GlobalUsings.g.cs`

For a console application, these were generated on my machine

```C#
// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;

```

Note that this is an autogenerated file, you can't edit it here (well, you can, but it doesn't help with anything).

The list of global usings is different for each project type, below is a Web project:

```C#
// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;
global using global::System.Net.Http.Json;
global using global::Microsoft.AspNetCore.Builder;
global using global::Microsoft.AspNetCore.Hosting;
global using global::Microsoft.AspNetCore.Http;
global using global::Microsoft.AspNetCore.Routing;
global using global::Microsoft.Extensions.Configuration;
global using global::Microsoft.Extensions.DependencyInjection;
global using global::Microsoft.Extensions.Hosting;
global using global::Microsoft.Extensions.Logging;
```

One can selectively remove and add namespace like so:

```XML
<ItemGroup>
  <Using Remove="System.Threading" />
  <Using Include="Microsoft.Extensions.DependencyInjection" />
</ItemGroup>
```

## Discussion

I feel Microsoft made a mistake by adding Global Implicit Namespaces - _I'm using namespaces insted of usings becuse using is also used(heh) in combination with [IDisposable](https://docs.microsoft.com/en-us/dotnet/api/system.idisposable?view=net-6.0) to control object lifecycle. If you do a google search for `using statements c#` the first link gets you here <https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using-statement>_.

### The Problem

But this isn't what I wanted to discuss. Implicit global namespaces  are hidden, one has to look for them in the obj folder to determine what's in there, and the list of implicit using is different from project to project.

I'm sure this will cause painful debugging sessions once old projects are migrated to .NET6 and devs encounter namespace collisions or class name clashes. Doing a `Ctrl + Shift + F` will not help anyone find the namespace collision, but it will lead to some interesting stackoverflow discussions.

### Potential Solution

The sane solutions in my opinion would have been for Microsoft to use the other feature they introduced in C# 10: **Global Usings** (note the missing implicit keyword).

Basically, instead of hiding away the default list of namespaces at a _hidden location_ like `[ProjectName]\obj\Debug\net6.0\[ProjectName].GlobalUsings.g.cs` folder, they could have introduced a class such as `GlobalUsings.cs` by default in every new project.

This aproach allows the developer to easily gawk at the default namespaces and quicky fix whatever weird namespace issue he's debugging.
